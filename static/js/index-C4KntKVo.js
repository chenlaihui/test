import{_ as Z,R as ee,K as se,r as u,w as te,o as ae,y as a,z as l,A as o,f as d,F as y,ae as b,N as v,E as L,ab as oe,ac as le,S as ne,d as re,ad as m,G as $,a2 as ce,U as ie,V as ue,I as de,a6 as ve}from"./index-CDHd4m-7.js";import{T as me}from"./index-D3_krIJX.js";import{E as ge}from"./index-Bb7nynEf.js";import{C as _e}from"./index-CViZOMyQ.js";import{_ as he,g as ye}from"./index-Ds3NWbdX.js";import{S as pe}from"./index-B2_E0uL9.js";import"./use-id-D2bIr3ea.js";import"./index-D-jpgpWR.js";import"./index-Biv-2Zfy.js";const k=S=>(ie("data-v-f11b8fb8"),S=S(),ue(),S),fe={class:"search-page"},be={class:"flex items-center px-4 py-2 bg-white border-b border-gray-100"},ke={class:"bg-white sticky top-0 z-50"},Se={key:0,class:"bg-white min-h-screen"},we={key:0,class:"flex justify-center py-6"},Ce={key:0,class:"suggest-section"},xe=k(()=>o("div",{class:"suggest-section-title"},"å®¢æˆ·",-1)),Ne=["onClick"],He={class:"suggest-icon"},Te={class:"suggest-content"},Ie=["innerHTML"],Le={class:"suggest-sub"},Ee={key:1,class:"border-t border-gray-100 mx-4"},Ve={key:2,class:"suggest-section"},Be=k(()=>o("div",{class:"suggest-section-title"},"ç³»ç»Ÿ",-1)),Oe=["onClick"],Re=k(()=>o("div",{class:"suggest-icon"},"ðŸ“¦",-1)),$e={class:"suggest-content"},Ae=["innerHTML"],qe={class:"suggest-sub"},ze={key:0,class:"bg-white px-4 py-3"},Me={class:"flex items-center justify-between mb-3"},Ue=k(()=>o("span",{class:"text-base font-bold"},"æœç´¢åŽ†å²",-1)),Ye={class:"flex flex-wrap gap-2 items-center"},De={key:1,class:"bg-white px-4 py-3 -mt-2"},Fe={class:"flex items-center justify-between mb-3"},Ke=k(()=>o("span",{class:"text-base font-bold"},"æµè§ˆåŽ†å²",-1)),je=["onClick"],Pe={class:"browse-avatar"},Je={class:"browse-name"},We={class:"browse-date"},Ge=re({name:"Search"}),Qe=Object.assign(Ge,{setup(S){const p=ee(),E=se(),x=u(E.query.tab||"customer"),A=[{label:"æœå®¢æˆ·",value:"customer"},{label:"æœäº§å“",value:"product"}],c=u(E.query.keyword||""),n=u([]),g=u(!1),w=u(!1),f=u([]),_=u([]),h=u([]),N=u(!1),H="searchHistory",V="browseHistory",B=4,q=["é›…é©¬å“ˆ","åˆå…‹è¨æ–¯","åˆå…‹è¨æ–¯ A1-QMS","A1","å¼ æ–‡é¾™","å¤©åº·ç‰©èµ„","åŽä¸ºæŠ€æœ¯","æ€ç§‘ç³»ç»Ÿ"],z=[{shortName:"åˆå…‹è¨æ–¯",name:"åˆå…‹è¨æ–¯",fullName:"åˆå…‹è¨æ–¯ç²¾å·¥ï¼ˆå˜‰å…´ï¼‰æœ‰é™å…¬å¸",date:"12-24"},{shortName:"é›…é©¬å“ˆ",name:"é›…é©¬å“ˆ",fullName:"é›…é©¬å“ˆå‘åŠ¨æœºï¼ˆåŽ¦é—¨ï¼‰ä¿¡æ¯ç³»ç»Ÿæœ‰é™å…¬å¸",date:"12-23"},{shortName:"å¤©åº·ç‰©èµ„",name:"å¤©åº·ç‰©èµ„",fullName:"é™•è¥¿å¤©åº·ç‰©èµ„æœ‰é™å…¬å¸",date:"12-22"}];let O=null;const M=()=>{try{const s=localStorage.getItem(V);s&&(f.value=JSON.parse(s)),f.value.length||(f.value=[...z])}catch{}},U=()=>{f.value=[],localStorage.removeItem(V)},Y=async s=>{if(!s||!s.trim()){_.value=[],h.value=[];return}N.value=!0;try{const e=await ye(s.trim());_.value=(e==null?void 0:e.customers)||[],h.value=(e==null?void 0:e.products)||[]}catch(e){console.error("æœç´¢å»ºè®®åŠ è½½å¤±è´¥:",e)}finally{N.value=!1}},D=()=>{try{const s=localStorage.getItem(H);s&&(n.value=JSON.parse(s)),n.value.length||(n.value=[...q])}catch{}},T=s=>{s.trim()&&(n.value=[s,...n.value.filter(e=>e!==s)].slice(0,20),localStorage.setItem(H,JSON.stringify(n.value)))},F=()=>{n.value=[],localStorage.removeItem(H)},I=s=>{const e=s||c.value;e.trim()&&(T(e),g.value=!1,x.value==="customer"?p.push({name:"CustomerList",query:{keyword:e}}):p.push({name:"ProductList",query:{keyword:e}}))},K=s=>{const e=s.shortName||s.fullName;T(e),g.value=!1,p.push({name:"CustomerList",query:{keyword:e}})},j=s=>{T(s.name),g.value=!1,p.push({name:"ProductList",query:{keyword:s.name}})},P=s=>{p.push({name:"CustomerDetail",query:{name:s.shortName||s.name}})},J=()=>{p.back()},R=(s,e)=>{if(!e||!s)return s;const r=s.toLowerCase().indexOf(e.toLowerCase());return r===-1?s:s.substring(0,r)+'<span class="text-blue-600 font-semibold">'+s.substring(r,r+e.length)+"</span>"+s.substring(r+e.length)};return te(c,s=>{const e=s.trim();g.value=e.length>0,clearTimeout(O),e.length>0?O=setTimeout(()=>Y(e),300):(_.value=[],h.value=[])}),ae(()=>{D(),M()}),(s,e)=>{const r=de,W=ve,G=_e,Q=ge,X=me;return a(),l("div",fe,[o("div",be,[d(r,{name:"arrow-left",size:"24",onClick:J,class:"mr-3 cursor-pointer"}),d(he,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=t=>x.value=t),tabs:A,class:"flex-1"},null,8,["modelValue"])]),o("div",ke,[d(pe,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=t=>c.value=t),placeholder:"è¯·è¾“å…¥å…¬å¸ã€ç³»ç»Ÿåç§°","show-back":!1,onSearch:e[2]||(e[2]=t=>I()),onFocus:e[3]||(e[3]=t=>g.value=c.value.trim().length>0)},null,8,["modelValue"])]),g.value?(a(),l("div",Se,[N.value?(a(),l("div",we,[d(W,{size:"20"})])):_.value.length||h.value.length?(a(),l(y,{key:1},[_.value.length?(a(),l("div",Ce,[xe,(a(!0),l(y,null,b(_.value,(t,i)=>(a(),l("div",{key:"c"+i,class:"suggest-item",onClick:C=>K(t)},[o("div",He,m(t.avatar||(t.shortName||"").charAt(0)),1),o("div",Te,[o("div",{class:"suggest-main",innerHTML:R(t.fullName||t.shortName,c.value)},null,8,Ie),o("div",Le,"ä¸Šæ¬¡æ‹œè®¿ï¼š"+m(t.lastVisit||"--"),1)]),d(r,{name:"arrow",class:"text-gray-300"})],8,Ne))),128))])):v("",!0),_.value.length&&h.value.length?(a(),l("div",Ee)):v("",!0),h.value.length?(a(),l("div",Ve,[Be,(a(!0),l(y,null,b(h.value,(t,i)=>(a(),l("div",{key:"p"+i,class:"suggest-item",onClick:C=>j(t)},[Re,o("div",$e,[o("div",{class:"suggest-main",innerHTML:R(t.name,c.value)},null,8,Ae),o("div",qe,m(t.category)+" Â· "+m(t.department),1)]),d(r,{name:"arrow",class:"text-gray-300"})],8,Oe))),128))])):v("",!0)],64)):(a(),l(y,{key:2},[(a(!0),l(y,null,b(n.value.filter(t=>t.includes(c.value)).slice(0,5),(t,i)=>(a(),L(G,{key:i,title:t,"is-link":"",onClick:C=>I(t)},{icon:$(()=>[d(r,{name:"clock-o",class:"mr-2 text-gray-400"})]),_:2},1032,["title","onClick"]))),128)),n.value.filter(t=>t.includes(c.value)).length?v("",!0):(a(),L(Q,{key:0,description:"æš‚æ— æœç´¢ç»“æžœ"}))],64))])):v("",!0),oe(o("div",null,[n.value.length?(a(),l("div",ze,[o("div",Me,[Ue,d(r,{name:"delete-o",size:"18",class:"text-gray-400 cursor-pointer",onClick:F})]),o("div",Ye,[(a(!0),l(y,null,b(w.value?n.value:n.value.slice(0,B),(t,i)=>(a(),L(X,{key:i,plain:"",round:"",color:"#e4e7ed","text-color":"#333",class:"history-pill cursor-pointer",onClick:C=>I(t)},{default:$(()=>[ce(m(t),1)]),_:2},1032,["onClick"]))),128)),n.value.length>B?(a(),l("div",{key:0,class:ne(["expand-btn",{expanded:w.value}]),onClick:e[4]||(e[4]=t=>w.value=!w.value)}," â–¼ ",2)):v("",!0)])])):v("",!0),f.value.length?(a(),l("div",De,[o("div",Fe,[Ke,d(r,{name:"delete-o",size:"18",class:"text-gray-400 cursor-pointer",onClick:U})]),(a(!0),l(y,null,b(f.value,(t,i)=>(a(),l("div",{key:i,class:"browse-item",onClick:C=>P(t)},[o("div",Pe,m((t.shortName||t.name||"").charAt(0)),1),o("div",Je,m(t.fullName||t.name),1),o("div",We,m(t.date||""),1)],8,je))),128))])):v("",!0)],512),[[le,!g.value]])])}}}),rs=Z(Qe,[["__scopeId","data-v-f11b8fb8"]]);export{rs as default};
